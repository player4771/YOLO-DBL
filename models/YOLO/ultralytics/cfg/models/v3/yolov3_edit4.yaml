# Ultralytics ğŸš€ AGPL-3.0 License - https://ultralytics.com/license

# Ultralytics YOLOv3 object detection model with P3/8 - P5/32 outputs
# Model docs: https://docs.ultralytics.com/models/yolov3
# Task docs: https://docs.ultralytics.com/tasks/detect

# Parameters
nc: 80 # number of classes
depth_multiple: 1.0 # model depth multiple
width_multiple: 1.0 # layer channel multiple


backbone:
  # [from, number, module, args]
  - [-1, 1, Conv, [64, 3, 2]] # 0-P1/2
  - [-1, 2, DSC3k2, [64, False, 0.25]]
  - [-1, 1, Conv, [128, 3, 2]] # P2/4
  - [-1, 2, DSC3k2, [128, False, 0.25]]
  - [-1, 1, Conv, [256, 3, 2]] # P3/8
  - [-1, 2, DSC3k2, [256, False, 0.25]]
  - [-1, 1, Conv, [512, 1, 1]] # è¿™æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„é€‚é…å±‚ï¼Œè¾“å‡ºåªé€šå‘HyperACE
  - [-2, 1, DSConv, [512, 3, 2]] # P4/16, è¿™å±‚çš„è¾“å…¥æ˜¯ä¸Šä¸Šå±‚ï¼Œè·³è¿‡äº†ä¸Šä¸€å±‚çš„è¾“å‡º
  - [-1, 4, A2C2f, [512, True, 4]]
  - [-1, 1, DSConv, [1024, 3, 2]] # P5/32
  - [-1, 4, A2C2f, [1024, True, 1]] # 10


head:
  - [[-5, -3, -1], 2, HyperACE, [512, 8, True, True]]
  - [-1, 1, Conv, [256, 1, 1]]
  - [-1, 1, nn.Upsample, [None, 2, 'nearest']]

  - [[8, -3], 1, FullPAD_Tunnel, []]
  - [[5, -2], 1, FullPAD_Tunnel, []]

  - [10, 2, DSC3k2, [1024, True]]

  - [-1, 1, Conv, [512, 3, 2]]
  - [-3, 2, DSC3k2, [512, True]]

  - [-1, 1, Conv, [256, 3, 2]]
  - [-3, 2, DSC3k2, [256, True]]
S
  - [[-1, -3, -5], 1, Detect, [nc]] # Detect(P3, P4, P5)
